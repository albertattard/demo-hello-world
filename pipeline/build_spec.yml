version: 0.1
component: build
timeoutInSeconds: 600
shell: bash
failImmediatelyOnError: true

steps:
  - type: Command
    name: 'Install Java 25'
    command: |
      wget https://download.oracle.com/java/25/latest/jdk-25_linux-x64_bin.rpm
      dnf -y install jdk-25_linux-x64_bin.rpm
      export JAVA_HOME='/usr/lib/jvm/jdk-25'
      export PATH="${JAVA_HOME}/bin:${PATH}"
      java --version

  - type: Command
    name: 'Build the application'
    command: |
      ./mvnw clean package

  - type: Command
    name: 'Get git commit hash'
    command: |
      VERSION=$(git rev-parse --short HEAD)
      echo "VERSION=${VERSION}" >> "${OCI_WORKSPACE}/env_file"
